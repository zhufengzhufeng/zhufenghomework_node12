<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>manger</title>
    <link rel="stylesheet" href="bootstrap.css">
</head>
<body class="container">
<form class="form-horizontal">
    <div class="form-group">
        <label for="username" class="control-label">用户名</label>
        <input type="text" id="username" placeholder="请输入用户名" class="form-control">
    </div>
    <div class="form-group">
        <label for="password" class="control-label">密码</label>
        <input type="text" id="password" placeholder="请输入密码" class="form-control">
    </div>
    <div class="form-group">
        <button type="button" class="btn btn-sm btn-success" id="btn">增加</button>
        <button type="reset" class="btn btn-sm btn-danger">重置</button>
    </div>
</form>
<ul class="list-group">
    <!-- <li class="list-group-item">
         用户名:xxxx 密码:xxxx
         <button type="button" class="pull-right btn btn-xs btn-danger">删除</button>
         <button type="button" class="pull-right btn btn-xs btn-success" style="margin-right: 10px">修改</button>
     </li>-->
</ul>
<script src="ajax.js"></script>
<script>
    var oUl = document.querySelector('.list-group');
    var add = document.querySelector('#btn');
    var username = document.querySelector('#username');
    var password = document.querySelector('#password');
    ajax({
        url: '/getUsers',
        success: function (resulet) {
            showList(resulet)
        }
    });
    function showList(data) {
        var str = '';
        data.forEach(function (item, index) {
            str += `<li class="list-group-item">
        用户名:${item.username} 密码:${item.password}
        <button type="button" class="pull-right btn btn-xs btn-danger" onclick="del(${item.id})">删除</button>
        <button type="button" class="pull-right btn btn-xs btn-success" onclick="skip(${item.id})" style="margin-right: 10px">修改</button>
    </li>`
        });
        oUl.innerHTML = str;
    }
    /*添加数据*/
    btn.addEventListener('click', function (e) {
        if (!(username.value || password.value)) {
            return alert('不能为空');
        }
        var obj = {
            username: username.value,
            password: password.value
        };
        ajax({
            url: 'addUser',
            type: 'post',
            data: obj,
            success: function (result) {
                username.value = password.value = '';
                showList(result)
            }
        })
    });
    /*删除数据*/
    function del(id) {
        ajax({
            url: '/delUser?id=' + id,
            type: 'delete',
            success: function (result) {
                showList(result)
            }
        })
    }
    /*跳转页面*/
    function skip(id) {
        location.href = 'update.html?id=' + id
    }
</script>
</body>
</html>